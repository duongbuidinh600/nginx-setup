# Upstream definitions for backend services
# This file defines connection pools to Docker services

upstream kafka_ui_backend {
    server localhost:8080 max_fails=3 fail_timeout=30s;
    keepalive 32;
}

upstream kibana_backend {
    server localhost:5601 max_fails=3 fail_timeout=30s;
    keepalive 16;
}

upstream elasticsearch_backend {
    server localhost:9200 max_fails=3 fail_timeout=30s;
    keepalive 16;
}

upstream adminer_backend {
    server localhost:8081 max_fails=3 fail_timeout=30s;
    keepalive 8;
}

upstream redis_commander_backend {
    server localhost:8082 max_fails=3 fail_timeout=30s;
    keepalive 8;
}

upstream nexus_backend {
    server localhost:8083 max_fails=3 fail_timeout=30s;
    keepalive 16;
}

# Common proxy headers
map $http_upgrade $connection_upgrade {
    default upgrade;
    '' close;
}
